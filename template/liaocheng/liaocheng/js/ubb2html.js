var bf=0,tpi=0;if(typeof(NotBf)!='undefined')
    bf=1;
if (typeof(huiyuan)=="undefined"){document.write("<script src='/inc/system.js'></script>");}
function ubb(id)
{if($(id))
{$(id).innerHTML=ubb2html($(id).innerHTML);}}
function vipubb(id)
{if($(id))
{$(id).innerHTML=txt2html($(id).innerHTML);}}
function jstubb(id)
{if($(id))
{$(id).innerHTML=jst2html($(id).innerHTML);}}
function getViewportWidth(){if(window.innerWidth!=window.undefined)return window.innerWidth;if(document.compatMode=='CSS1Compat')return document.documentElement.clientWidth;if(document.body)return document.body.clientWidth;return window.undefined;}
function DrawImage(ImgD,FitWidth,FitHeight){var image=new Image();image.src=ImgD.src;if(image.width>0){if(FitWidth>parseInt(getViewportWidth()-255)){FitWidth=getViewportWidth()-255;}
    if(image.width/image.height>=FitWidth/FitHeight){if(image.width>FitWidth){ImgD.width=FitWidth;ImgD.height=(image.height*FitWidth)/image.width;}else{ImgD.width=image.width;ImgD.height=image.height;}}else{if(image.height>FitHeight){ImgD.height=FitHeight;ImgD.width=(image.width*FitHeight)/image.height;}else{ImgD.width=image.width;ImgD.height=image.height;}}}}
function ubb2html(str)
{str=str.replace(/([&nbsp;|\s]{0,}<br.{0,2}>[&nbsp;|\s]{0,}){3,}/gim,"<br /><br />");str = str.replace(/\[u\](.+?)\[\/u\]/gim,"<u>$1</u>");str = str.replace(/\[b\](.+?)\[\/b\]/gim,"<b>$1</b>");str = str.replace(/\[i\](.+?)\[\/i\]/gim,"<i>$1</i>");str = str.replace(/\[\/?(u|b|i)\]/gi,"");str=str.replace(/’/gim,"'");str = str.replace(/\[img\](.+?)\[\/img\]/gi,function($0,$1){tpi++;var img_i=tpi;setTimeout(function(){$(img_i).src=$1;},tpi*550+tpi/5*500);return("<a href=\""+$1+"\" target=\"_blank\"><img src=\"/image/img.gif\" onload=\"javascript:DrawImage(this,760,760);\" onerror=\"this.src='/image/errimg.gif'\" id=\""+img_i+"\" /><\/a>")});str=str.replace(/\[em(.[^\[]*)\]/gi,function($0,$1){return("<img src=/bbs/em/"+$1+".gif border=0 align=middle>")});str=str.replace(/\[url=(.+?)\](.+?)\[\/url\]/gi,function($0,$1,$2){return("<a href=\""+$1+"\" target=_blank>"+$2+"</a>")});str=str.replace(/\[url\](.+?)\[\/url\]/gi,function($0,$1){return("<a href=\""+$1+"\" target=_blank>"+$1+"</a>")});str=str.replace(/\[color=([#\w]{3,})\]/gi,"<font color=\"$1\">");str=str.replace(/\[size=(\d{1})\]/gi,"<font size=\"$1\">");str=str.replace(/\[\/(color|size)\]/gi,"</font>");str=str.replace(/\[quote\]/gim,"<div style=\"border: 1px dashed #ccc;width:96%; color: #888;font-size: 12px;background-color: #f9f9f9;padding:5px;margin-bottom:8px;\">");str=str.replace(/\[\/quote\]/gim,"</div>");str=str.replace(/\[flash\](.+?)\[\/flash\]/i,function($0,$1){if(bf<1){return("<div style=\"position:relative;z-index:21;\"><div style=\"position: absolute; z-index:22;margin:2px 0px 0px 379px;width:119px; height:27px; filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/tp/image/sy_logo.png', sizingMethod='crop');\"></div><embed src=\""+$1+"\" width=500 height=400 border=0 allowScriptAccess=always allowfullscreen=true wmode=transparent></embed></div>")}else{return("<img src=/edit/ubb/image/swf.gif border=0> "+shuziren_bf($1,480,360,1))}});str=str.replace(/\[mp=([0-9]{1,4}),([0-9]{1,4})\](.+?)\[\/mp\]/i,function($0,$1,$2,$3){if(bf<1){return("<object align=middle classid=CLSID:22d6f312-b0f6-11d0-94ab-0080c74c7e95 class=OBJECT id=md"+bf+" width="+$1+" height="+$2+" ><param name=ShowStatusBar value=-1><param name=Filename value=\""+$3+"\"><embed type=application/x-oleobject codebase=http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701 flename=mp src=\""+$3+"\" width="+$1+" height="+$2+"></embed><PARAM NAME=AUTOSTART VALUE=1></object>")}else{return("<img src=/edit/ubb/image/wma.gif border=0> "+shuziren_bf($3,$1,$2,2))}});str=str.replace(/\[rm=([0-9]{1,4}),([0-9]{1,4})\](.+?)\[\/rm\]/i,function($0,$1,$2,$3){if(bf<1){return("<OBJECT classid=clsid:CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA class=OBJECT id=RAOCX width="+$1+" height="+$2+"><PARAM NAME=SRC VALUE=\""+$3+"\"><PARAM NAME=CONSOLE VALUE=\""+$3+"\"><PARAM NAME=CONTROLS VALUE=imagewindow><PARAM NAME=AUTOSTART VALUE=true></OBJECT><br><OBJECT classid=CLSID:CFCDAA03-8BE4-11CF-B84B-0020AFBBCCFA height=32 id=video2 width="+$1+"><PARAM NAME=SRC VALUE=\""+$3+"\"><PARAM NAME=AUTOSTART VALUE=0><PARAM NAME=CONTROLS VALUE=controlpanel><PARAM NAME=CONSOLE VALUE=\""+$3+"\"></OBJECT>")}else{return("<img src=/edit/ubb/image/real.gif border=0> "+shuziren_bf($3,$1,$2,3))}});str=str.replace(/\[flv\](.+?)\[\/flv\]/i,function($0,$1){if(bf<1){return("<embed src=\"/inc/flv.swf?file="+$1+"&autostart=true&logo=/tp/image/sy_logo.png\" width=500 height=400 border=0 allowScriptAccess=always allowfullscreen=true>")}else{return("<embed src=\"/inc/flv.swf?file="+$1+"&autostart=false&logo=/tp/image/sy_logo.png\" width=500 height=400 border=0 allowScriptAccess=always allowfullscreen=true></embed>")}});str=str.replace(/\[csound\](.+?)\[\/csound\]/,function($0,$1){return("<img src=/edit/ubb/image/mid.gif border=0><a href=\""+$1+"\" target=_blank>背景音乐:"+$1+"</a><bgsound src=\""+$1+"\" border=0 loop=-1><br>")});str=str.replace(/\[align=(left|center|right)\]/gim,"<div style=\"text-align:$1\">");str=str.replace(/\[\/align\]/gim,"</div>");if(str.match(/\[table/ig)){str=str.replace(/\[table(=(\d{1,3}%?))?\]/ig,function($1,$2,$3){return parsetable($3);});str=str.replace(/\[\/table\]/ig,'</table>');str=str.replace(/\[td=(\d{1,2}),(\d{1,2})(,(\d{1,3}%?))?\]/ig,'<td colspan="$1" rowspan="$2" width="$4">');str=str.replace(/\[tr\]/ig,'<tr>');str=str.replace(/\[td\]/ig,'<td>');str=str.replace(/\[\/td\]/ig,'</td>');str=str.replace(/\[\/tr\]/ig,'</tr>');}str = str.replace(/\[tag\](.+?)\[\/tag\]/,function($0,$1){return(tag_url($1));});return str;}
function txt2html(str)
{str=str.replace(/(<br>){2,}/gim,"<br>");str=str.replace(/\[img\](.+?)\[\/img\]/i,function($0,$1){return("<img src=\""+$1+"\"  width=\"1\" onload=\"javascript:DrawImage(this,468,240);\" />")});str=str.replace(/\[url=(.+?)\](.+?)\[\/url\]/gi,function($0,$1,$2){return("<a href=\""+$1+"\" target=_blank>"+$2+"</a>")});str=str.replace(/\[url\](.+?)\[\/url\]/gi,function($0,$1){return("<a href=\""+$1+"\" target=_blank>"+$1+"</a>")});return str;}
function jst2html(str)
{str = str.replace(/\[(\/?(u|b|i))\]/gi,"<$1>");str=str.replace(/\[em(.[^\[]*)\]/gi,function($0,$1){return("<img src=/bbs/em/"+$1+".gif border=0 align=middle>")});str=str.replace(/\[img\](.+?)\[\/img\]/gim,function($0,$1){return("<img src=\""+$1+"\" width=\"1\" onload=\"javascript:DrawImage(this,468,240);\" />")});str=str.replace(/\[url=(.+?)\](.+?)\[\/url\]/gi,function($0,$1,$2){return("<a href=\""+$1+"\" target=_blank>"+$2+"</a>")});str=str.replace(/\[url\](.+?)\[\/url\]/gi,function($0,$1){return("<a href=\""+$1+"\" target=_blank>"+$1+"</a>")});return str;}
var urlid=0;function xsbf()
{for(var n=0;n<urlid;n++)
{if($('urlid_'+n).style.display=='inline')$('urlid_'+n).style.display='none';}}
function shuziren_bf(u,k,g,lx)
{var t="<span name=urlid_"+urlid+" id=urlid_"+urlid+" style=\"DISPLAY: none;filter:alpha(opacity=90);padding:6px;font-size:9pt;border: 1px solid #ccc;background: #ffc;POSITION: absolute;text-align:center;\"><font color=gray>"+u+"</font><br><font color=red>访问网址不能确定是否安全，是否继续访问？</font> <br><span style=\"cursor:hand\" onclick='openWindow(\""+u+"\",\"在线播放器\","+k+","+g+","+lx+");this.parentNode.style.display=\"none\"'>√继续访问</span>&nbsp;&nbsp;<span style=\"cursor:hand\" onclick='this.parentNode.style.display=\"none\"'>×取消访问</span></span>";urlid++;return("<span>"+t+"</span><a href='"+u+"' target='_blank' onclick='xsbf();urlbfts(this).childNodes[0].style.display=\"inline\";return false'>"+u+"</a>");}
function urlbfts(i)
{var v=i.previousSibling;while(v.nodeType==3){v=v.previousSibling;}
    return v;}
function parsetable(width){if(typeof width=='undefined'){var width='98%';}else{width=width.substr(width.length-1,width.length)=='%'?(width.substr(0,width.length-1)<=98?width:'98%'):(width<=700?width:'98%');}
    return'<table '
        +(width==''?'':'width="'+width+'" ')
        +' class="mytable">';}
function tag_url(str){var lk=240;if (window.location.href.indexOf('/zhidao/')>-1){lk=320;}var tags=str.split(",");str="";for (var i=0;i<tags.length;i++){if (i>0){str+=",";}str+="<a href=\"/so/?px=1&key="+escape(tags[i])+"\">"+tags[i]+"</a> ";}str="<span style=\"font-size:9pt;position: absolute;margin:-28px 0 0 "+lk+"px;\">TAG："+str+"</span>";return str;}